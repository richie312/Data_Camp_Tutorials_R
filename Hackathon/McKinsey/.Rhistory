master_data$Gender[1:10]
master_data$Gender[]<-lapply(master_data$Gender[],as.numric)
master_data$Gender[]<-lapply(master_data$Gender[],as.numeric)
master_data$Gender[1:10]
remove(master_data)
master_data<-read.csv("train.csv")
as.numeric(master_data$Gender)
master_data$Gender<-as.numeric(master_data$Gender)
master_data$Gender[1:10]
str(data_log)
remove(data_log)
myLetters<-toupper(letters[1:26])
data_log$City_Category<-match(data_log$City_Category, myLetters)
data_log$Employer_Category1<-match(data_log$Employer_Category1,myLetters)
data_log$Primary_Bank_Type<-match(data_log$Primary_Bank_Type,myLetters)
data_log$Source_Category<-match(data_log$Source_Category,myLetters)
data_log<-master_data[,c(1,2,6,8,9,10,12,15,16,17,18,19,20,21,22)]
myLetters<-toupper(letters[1:26])
data_log$City_Category<-match(data_log$City_Category, myLetters)
data_log$Employer_Category1<-match(data_log$Employer_Category1,myLetters)
data_log$Primary_Bank_Type<-match(data_log$Primary_Bank_Type,myLetters)
data_log$Source_Category<-match(data_log$Source_Category,myLetters)
str(data_log)
data_log_cor<-cor(data_log, use='complete.obs')
cor(data_log$Gender,data_log$Approved)
cor(data_log$City_Category,data_log$Approved)
master_data<-read.csv("train.csv",stringsAsFactors = FALSE)
names(master_data)
str(master_data)
data_log<-master_data[,c(1,2,6,8,9,10,12,15,16,17,18,19,20,21,22)]
str(data_log)
master_data$Gender<-as.numeric(master_data$Gender)
data_log$Gender[1:!0]
data_log$Gender[1:10]
master_data$Gender<-as.numeric(master_data$Gender)
master_data$Gender[1:10]
remove(data_log)
remove(master_data)
master_data<-read.csv("train.csv")
data_log<-master_data[,c(1,2,6,8,9,10,12,15,16,17,18,19,20,21,22)]
str(data_log)
master_data$Gender<-as.numeric(master_data$Gender)
data_log$City_Category<-as.numeric(data_log$City_Category)
data_log$City_Category[1:10]
str(data_log$City_Category)
str(data_log)
data_log$Gender<-as.numeric(master_data$Gender)
data_log$City_Category<-as.numeric(data_log$City_Category)
data_log$Employer_Category1<-as.numeric(data_log$Employer_Category1)
data_log$Primary_Bank_Type<-as.numeric(data_log$Primary_Bank_Type)
data_log$Source_Category<-as.numeric(data_log$Source_Category)
str(data_log)
data_log=as.numeric(data_log)
data_log=as.numeric(data_log[,])
data_log[] <- lapply(data_log, function(x)
as.numeric(factor(x, levels=letters[1:10])))
str(data_log)
remove(data_log)
data_log<-master_data[,c(1,2,6,8,9,10,12,15,16,17,18,19,20,21,22)]
str(data_log)
data_log<-lapply(as.numeric,data_log)
nrow(data_log)
data_log<-sapply(data_log, as.numeric)
str(data_log)
head(data_log)
data_log_cor<-cor(data_log, use='complete.obs')
data_log_cor
library(corrplot)
cor_matrix<-corrplot(data_log_cor)
class(data_log)
data_log<-as.data.frame(data_log)
nrow(data_log)
M1=glm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+var1,family='binomial',method='glm.fit',data=data_log)
M1=glm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family='binomial',method='glm.fit',data=data_log)
test<-read.csv("test.csv")
Pred_M1=predict(M1,data=test)
Pred_M1
data_log$Approved[1:101]
M1
library(gbm)
Pred_M1=predict(M1,data=test,type='response')
Pred_M1
tail(Pred_M1)
remove(M1)
remove(Pred_M1)
M1=gbm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family='binomial',n.trees=1000,method='glm.fit',data=data_log)
M1=gbm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family='binomial',n.trees=1000,data=data_log)
M1=gbm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,distribution='binomial',n.trees=1000,data=data_log)
M1=gbm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,distribution='bernoulli',n.trees=1000,data=data_log)
Pred_M1=predict(M1,data=test,n.tree=1000,type='response')
Pred_M1
remove(Pred_M1)
Pred_M1=plogis(predict(M1,data=test,n.tree=1000,type='response'))
Pred_M1
M2=glm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family=binomial(link='logit'),data=data_log)
M
M2
Pred_M2=predict(M2,data=test)
Pred_M2
Pred_M2=plogis(predict(M2,data=test))
Pred_M2
## Convert all of them to numeric
data_log_cor<-sapply(data_log, as.numeric)
data_log_cor<-as.data.frame(data_log)
## Examine the data Structure
str(data_log)
remove(data_log)
data_log<-master_data[,c(1,2,6,8,9,10,12,15,16,17,18,19,20,21,22)]
str(data_log)
M2=glm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family=binomial(link='logit'),data=data_log)
Pred_M2=plogis(predict(M2,data=test))
Pred_M2
Pred_M2=predict(M2,data=test)
Pred_M2
Pred_M2=predict(M2,data=test,type='response')
Pred_M2
neames(test)
names(test)
remove(Pred_M2)
Pred_M2=predict(M2,data=subset(test,select=c(2,6,8,9,12,16,17,19,20,21)),type='response')
Pred_M2
Pred_M2<- ifelse(Pred_M2 > 0.5,1,0)
Pred_M2
sample<-read.csv("Sample_Solution.csv")
sample
Sample$ID=paste(test$ID)
Sample$Approved=paste(Pred_M2)
sample$ID=paste(test$ID)
Sample=data.frame(test$ID,Pred_M2)
nrow(Pred_M2)
Pred_M1
nrow(test)
Pred_M2
remove(Pred_M1)
remove(Pred_M2)
Pred_M2=predict(M2,data=subset(test,select=c(2,6,8,9,12,16,17,19,20,21)),type='response')
Sample=data.frame(test$ID,Pred_M2)
str(test)
str(data)
remove(Pred_M2)
Pred_M2=predict(M2,data=test[,c(2,6,8,9,12,16,17,19,20,21)],type='response')
Pred_M2
nrows(data_log)
nrows(data_Log)
nrow(data_log)
data.frame(Pred_M2)
nrow(Pred_M2)
M3<-as.data.frame(Pred_M2)
nrow(M3)
nrow(test)
nrow(data())
nrow(data)
data=test[,c(2,6,8,9,12,16,17,19,20,21)],
data=test[,c(2,6,8,9,12,16,17,19,20,21)]
nrow(data)
remove(M2)
M2
M2=glm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family=binomial(link='logit'),data=data_log)
Pred_M2=predict(M2,data=test[,c(2,6,8,9,12,16,17,19,20,21)],type='response')
Pred_M2
Pred_M2=predict.glm(M2,data=test[,c(2,6,8,9,12,16,17,19,20,21)],type='response')
Pred_M2=predict.glm(M2,data=test[,c(2,6,8,9,12,16,17,19,20,21)])
Pred_M2
Pred_M2=predict.glm(M2,data=test[,c(1,2,6,8,9,12,16,17,19,20,21)])
Pred_M2
Sample=data.frame(data$ID,Pred_M2)
data$ID[1:10]
Test_Data=test[,c(1,2,6,8,9,12,16,17,19,20,21)]
nrow(Test_Data
)
remove(Pred_M2)
Pred_M2=predict.glm(M2,data=Test_Data, type='response')
Pred_M2
M2
is.na(Test_Data)
Test_Data$Loan_Amount[is.na(Test_Data$Loan_Amount)] <- mean(Test_Data$Loan_Amount,na.rm=T)
is.na(Test_Data$Loan_Amount)
is.na(Test_Data)
Test_Data$Interest_Rate[is.na(Test_Data$Interest_Rate)] <- mean(Test_Data$Interest_Rate,na.rm=T)
Test_Data$EMI[is.na(Test_Data$Var1)]<-mean(Test_Data$EMI,na.rm=T)
which.is.na(Test_Data)
which(is.na(Test_Data))
which(Test_Data,na.rm=T)
which(Test_Data,is.na=T)
is.na(Test_Data)
Test_Data$EMI[is.na(Test_Data$Var1)]<-mean(Test_Data$EMI,na.rm=T)
is.na(Test_Data)
Test_Data$EMI[is.na(Test_Data$EMI)]<-mean(Test_Data$EMI,na.rm=T)
is.na(Test_Data)
remove(M2)
remove(Pred_m2)
M2=glm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family=binomial(link='logit'),data=data_log)
Pred_M2=predict.glm(M2,data=Test_Data, type='response')
Pred_M2
M3<-data.frame(Pred_M2)
nrow(M3)
nrow(M2)
m4<-data.frame(M2)
M2
nrow(Test_Data)
names(Test_Data)
is.any(is.na(Test_Data$Primary_Bank_Type))
any(is.na(Test_Data$Primary_Bank_Type))
any(is.na(Test_Data$Existing_EMI))
Test_Data$Existing_EMI[is.na(Test_Data$Existing_EMI)]<-mean(Test_Data$Existing_EMI,na.rm=T)
Test_Data$City_Category[is.na(Test_Data$City_Category)] <- mode(Test_Data$City_Category,na.rm=T)
Test_Data$Employer_Category1[is.na(Test_Data$Employer_Category1)] <- mode(Test_Data$Employer_Category1,na.rm=T)
Test_Data$Employer_Category2[is.na(Test_Data$Employer_Category2)] <- mode(Test_Data$Employer_Category2,na.rm=T)
Test_Data$EMI[is.na(Test_Data$EMI)]<-mean(Test_Data$EMI,na.rm=T)
mode(Test_Data$City_Category)
mean(Test_Data$Loan_Amount)
class(Test_Data$City_Category)
mode(as.numeric(Test_Data$City_Category))
Test_Data<-sapply(Test_Data, as.numeric)
Test_Data<-as.data.frame(Test_Data)
Test_Data$City_Category[is.na(Test_Data$City_Category)] <- mode(Test_Data$City_Category,na.rm=T)
mode(Test_Data$City_Category)
remove(Test_Data)
Test_Data=test[,c(1,2,6,8,9,12,16,17,19,20,21)]
Test_Data<-sapply(Test_Data, as.numeric)
Test_Data<-as.data.frame(Test_Data)
Test_Data$Loan_Amount[is.na(Test_Data$Loan_Amount)] <- mean(Test_Data$Loan_Amount,na.rm=T)
Test_Data$Interest_Rate[is.na(Test_Data$Interest_Rate)] <- mean(Test_Data$Interest_Rate,na.rm=T)
Test_Data$EMI[is.na(Test_Data$EMI)]<-mean(Test_Data$EMI,na.rm=T)
Test_Data$Existing_EMI[is.na(Test_Data$Existing_EMI)]<-mean(Test_Data$Existing_EMI,na.rm=T)
Test_Data$City_Category[is.na(Test_Data$City_Category)] <- mode(Test_Data$City_Category,na.rm=T)
class(Test_Data$City_Category)
Test_Data$City_Category[1:10]
head(Test_Data)
mean(Test_Data$City_Category)
median(Test_Data$City_Category)
mode(Test_Data$City_Category)
max(Test_Data$City_Category)
frequency(Test_Data$City_Category)
tabulate(Test_Data$City_Category)
which.amx(tabulate(Test_Data$City_Category))
which.max(tabulate(Test_Data$City_Category))
Test_Data$City_Category[is.na(Test_Data$City_Category)] <- which.max(tabulate(Test_Data$City_Category),na.rm=T)
Test_Data$City_Category[is.na(Test_Data$City_Category)] <- which.max(tabulate(Test_Data$City_Category))
any(is.na(Test_Data$City_Category))
Test_Data$Employer_Category1[is.na(Test_Data$Employer_Category1)] <- which.max(tabulate(Test_Data$Employer_Category1))
Test_Data$Employer_Category2[is.na(Test_Data$Employer_Category2)] <- which.max(tabulate(Test_Data$Employer_Category2))
any(is.na(Test_Data))
any(is.na(Test_Data))
Remove(M2)
M2=glm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family=binomial(link='logit'),data=data_log)
Pred_M2=predict.glm(M2,data=Test_Data, type='response')
Pred_M2
nrow(Test_Data)
is.na(data_log)
data_log$Loan_Amount[is.na(data_log$Loan_Amount)] <- mean(data_log$Loan_Amount,na.rm=T)
data_log$Interest_Rate[is.na(data_log$Interest_Rate)] <- mean(data_log$Interest_Rate,na.rm=T)
data_log$EMI[is.na(data_log$EMI)]<-mean(data_log$EMI,na.rm=T)
data_log$Existing_EMI[is.na(data_log$Existing_EMI)]<-mean(data_log$Existing_EMI,na.rm=T)
data_log$City_Category[is.na(data_log$City_Category)] <- which.max(tabulate(data_log$City_Category))
data_log$Employer_Category1[is.na(data_log$Employer_Category1)] <- which.max(tabulate(data_log$Employer_Category1))
data_log$Employer_Category2[is.na(data_log$Employer_Category2)] <- which.max(tabulate(data_log$Employer_Category2))
remove(data_log)
data_log<-master_data[,c(1,2,6,8,9,10,12,15,16,17,18,19,20,21,22)]
data_log_cor<-sapply(data_log, as.numeric)
data_log_cor<-as.data.frame(data_log)
str(data_log)
data_log<-sapply(data_log, as.numeric)
data_log<-as.data.frame(data_log)
str(data_log)
data_log$Loan_Amount[is.na(data_log$Loan_Amount)] <- mean(data_log$Loan_Amount,na.rm=T)
data_log$Interest_Rate[is.na(data_log$Interest_Rate)] <- mean(data_log$Interest_Rate,na.rm=T)
data_log$EMI[is.na(data_log$EMI)]<-mean(data_log$EMI,na.rm=T)
data_log$Existing_EMI[is.na(data_log$Existing_EMI)]<-mean(data_log$Existing_EMI,na.rm=T)
data_log$City_Category[is.na(data_log$City_Category)] <- which.max(tabulate(data_log$City_Category))
data_log$Employer_Category1[is.na(data_log$Employer_Category1)] <- which.max(tabulate(data_log$Employer_Category1))
data_log$Employer_Category2[is.na(data_log$Employer_Category2)] <- which.max(tabulate(data_log$Employer_Category2))
any(is.na(data_log))
names(data_log)
any(is.na(data_log$Primary_Bank_Type))
any(is.na(data_log$Existing_EMI))
any(is.na(data_log$Loan_Amount))
any(is.na(data_log$Interest_Rate))
any(is.na(data_log$EMI))
any(is.na(data_log$Var1))
any(is.na(data_log$Gender))
any(is.na(data_log$Approved))
M2\
M2
remove(M2)
M=glm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family=binomial(link='logit'),data=data_log)
Pred=predict.glm(M,data=Test_Data, type='response')
Pred
Sample=data.frame(data$ID,Pred)
Sample=data.frame(Test_Data$ID,Pred)
remove(data_log)
M
Pred=predict.glm(M, type='response')
Pred=predict(M, type='response')
Pred
Pred=predict(data_log, type='response')
Pred=predict(Test_Data, type='response')
Pred=predict.gbm(M,Test_Data, type='response')
M=gbm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family=binomial(link='logit'),data=data_log)
M=gbm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,distribution='bernoulli',n.trees=1000,data=data_log)
nrow(data_l,og)
nrow(data_log)
any(is.na(data_log))
data_log<-master_data[,c(1,2,6,8,9,10,12,15,16,17,18,19,20,21,22)]
str(data_log)
data_log<-sapply(data_log, as.numeric)
data_log<-as.data.frame(data_log)
str(data_log)
data_log_cor<-cor(data_log_cor, use='complete.obs')
cor_matrix<-corrplot(data_log_cor)
data_log$Loan_Amount[is.na(data_log$Loan_Amount)] <- mean(data_log$Loan_Amount,na.rm=T)
data_log$Interest_Rate[is.na(data_log$Interest_Rate)] <- mean(data_log$Interest_Rate,na.rm=T)
data_log$EMI[is.na(data_log$EMI)]<-mean(data_log$EMI,na.rm=T)
data_log$Existing_EMI[is.na(data_log$Existing_EMI)]<-mean(data_log$Existing_EMI,na.rm=T)
data_log$City_Category[is.na(data_log$City_Category)] <- which.max(tabulate(data_log$City_Category))
data_log$Employer_Category1[is.na(data_log$Employer_Category1)] <- which.max(tabulate(data_log$Employer_Category1))
data_log$Employer_Category2[is.na(data_log$Employer_Category2)] <- which.max(tabulate(data_log$Employer_Category2))
any(is.na(data_log))
M=gbm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,distribution='bernoulli',n.trees=1000,data=data_log)
Pred=predict.gbm(M,Test_Data, type='response')
Pred=predict.gbm(M,Test_Data, n.trees=1000, type='response')
Pred
Pred<- ifelse(Pred > 0.5,1,0)
Pred
Sample=data.frame(Test_Data$ID,Pred)
write.csv(Sample,"Sample_Solution.csv")
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution.csv")
remove(Sample)
remove(Pred)
Pred=predict.gbm(M,Test_Data, n.trees=1000, type='response')
Sample=data.frame(Test_Data$ID,Pred)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution.csv")
Test_Data$ID[1:10]
Sample=data.frame(Test$ID,Pred)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution.csv")
Sample=data.frame(test$ID,Pred)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution.csv")
write.csv(Sample,"Sample_Solution.csv")
nrow(data_log)
library(caTools)
set.seed(101)
set.seed(101)
split=sample.split(data_log$ID,split=0.7)
train=subset(data_log,split=TRUE)
test=subset(data_log,split=FALSE)
remove(test)
train_val=subset(data_log,split=FALSE)
nrow(train_val)
set.seed(101)
split=sample.split(data_log$ID,split=0.7)
remove(train_val)
odel performance
set.seed(101)
split=sample.split(data_log$ID,Split=0.7)
train=subset(data_log,split=TRUE)
train_val=subset(data_log,split=FALSE)
nrow(train_val)
nrow(train_val)
remove(train_val)
set.seed(101)
split=sample.split(data_log$ID,Split=0.7)
train=subset(data_log,split==TRUE)
train_val=subset(data_log,split==FALSE)
nrow(train_val)
any(is.na(train))
M_train=gbm(train$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,distribution='bernoulli',n.trees=1000,data=train)
Validation<-predict.gbm(M_train,train_val,n.trees=1000,type='response')
Validation
Error <- mean(M_train != train_val$Approved)
prf <- performance(Validation, measure = "tpr", x.measure = "fpr")
install.packages("ROCR")
librar(rock)
library(ROCR)
prf <- performance(Validation, measure = "tpr", x.measure = "fpr")
performance(Validation)
performance(Validation, measure=\auc)
performance(Validation, measure='auc')
Pred<- ifelse(Pred > 0.5,1,0)
Sample=data.frame(test$ID,Pred)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution1.csv")
test<-read.csv("test.csv")
Sample=data.frame(test$ID,Pred)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution1.csv")
pr<-prediction(M_train,train_val$Approved)
M_train=glm(train$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family='binomial',data=train)
Validation<-predict(M_train,train_val,n.trees=1000,type='response')
pr<-prediction(M_train,train_val$Approved)
Validation
M_train=glm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,family='binomial',data=data_log)
Pred_M_train<-predict(M_train,Test_Data,type='response')
prf <- performance(Pred_M_train, measure = "tpr", x.measure = "fpr")
Sample=data.frame(test$ID,Pred_M_train)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution2.csv")
pr<-prediction(M_train,train_val$Approved)
data_log_cor<-cor(data_log, use='complete.obs')
data_log_cor
remove(M)
remopve(Pred)
remove(Pred)
M=gbm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,distribution='bernoulli',n.trees=2500,data=data_log)
Pred=predict.gbm(M,Test_Data, n.trees=2500, type='response')
Sample=data.frame(test$ID,Pred)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution_ntrees_2500.csv")
gbm.step(data_log)
install.package("dismo")
install.packages("dismo")
library(dismo)
gbm.step(data_log)
gbm.step(data=data_log,gbm.x=c("Gender","City_Category","Employer_Category","Employer_Category2","Primary_Bank_Type",
"Existing_EM","Loan_Amount","Interest_Rate","EMI","Var1"),gbm.y=c("Approved"),
learning.rate = 0.01,family='bernoulli')
gbm.step(data_log,gbm.x=c("Gender","City_Category","Employer_Category","Employer_Category2","Primary_Bank_Type",
"Existing_EM","Loan_Amount","Interest_Rate","EMI","Var1"),gbm.y=c("Approved"),
learning.rate = 0.01,family='bernoulli')
gbm.step(data_log,gbm.x=data_log$Gender,data_log$City_Category,data_log$Employer_Category,data_log$Employer_Category2,data_log$Primary_Bank_Type,
data_log$Existing_EM,data_log$Loan_Amount,data_log$Interest_Rate,data_log$EMI,data_log$Var1), gbm.y=data_log$Approved,
learning.rate = 0.01 , family='bernoulli')
gbm.step(data_log,gbm.x=data_log$Gender,data_log$City_Category,data_log$Employer_Category,data_log$Employer_Category2,data_log$Primary_Bank_Type,
data_log$Existing_EM,data_log$Loan_Amount,data_log$Interest_Rate,data_log$EMI,data_log$Var1, gbm.y=data_log$Approved,
learning.rate = 0.01,family='bernoulli')
M=gbm(data_log$Approved~Gender+City_Category+Employer_Category1+Employer_Category2+Primary_Bank_Type
+Existing_EMI+Loan_Amount+Interest_Rate+EMI+Var1,distribution='bernoulli',n.trees=3000,data=data_log)
Pred=predict.gbm(M,Test_Data, n.trees=3000, type='response')
Sample=data.frame(test$ID,Pred)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution_ntrees_3000.csv")
data_log_cor<-cor(data_log_cor, use='complete.obs')
data_log_cor
M=gbm(data_log$Approved~Gender+City_Category+Employer_Category2+Primary_Bank_Type+Monthly_Income+Source_Category
+Existing_EMI+Loan_Period+Interest_Rate+Var1,distribution='bernoulli',n.trees=3000,data=data_log)
Pred=predict.gbm(M,test, n.trees=3000, type='response')
Sample=data.frame(test$ID,Pred)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution_ntrees_3000_alt_model.csv")
names(Test_Data)
names(test)
Test_Data=test[,c(1,2,6,9,10,12,15,16,18,19,21)]
names(Test_Data)
Test_Data<-sapply(Test_Data, as.numeric)
Test_Data<-as.data.frame(Test_Data)
Test_Data$Loan_Period[1:10]
Test_Data$Loan_Period[is.na(Test_Data$Loan_Amount)] <- mean(Test_Data$Loan_Period,na.rm=T)
any(is.na(Test_Data$Loan_Period))
mean(Test_Data)
mean(Test_Data$Loan_Period)
class(Test_Data$Loan_Period)
tabulate(Test_Data$Loan_Period)
Test_Data$Loan_Period[is.na(Test_Data$Loan_Amount)] <- which.max(Test_Data$Loan_Period)
remove(Test_Data)
Test_Data=test[,c(1,2,6,9,10,12,15,16,18,19,21)]
Test_Data<-sapply(Test_Data, as.numeric)
Test_Data<-as.data.frame(Test_Data)
Test_Data$Loan_Period[is.na(Test_Data$Loan_Period)] <- which.max(Test_Data$Loan_Period)
Test_Data$Source_Category[is.na(Test_Data$Source_Category)] <- which.max(tabulate(Test_Data$Source_Category))
any(is.na(Test_Data$Primary_Bank_Type))
any(is.na(Test_Data$Monthly_Income))
any(is.na(data_log$Primary_Bank_Type))
any(is.na(data_log$Monthly_Income))
any(is.na(data_log$Source_Category))
any(is.na(data_log$Loan_Period))
data_log$City_Category[is.na(data_log$City_Category)] <- which.max(tabulate(data_log$City_Category))
data_log$Employer_Category1[is.na(data_log$Employer_Category1)] <- which.max(tabulate(data_log$Employer_Category1))
data_log$Employer_Category2[is.na(data_log$Employer_Category2)] <- which.max(tabulate(data_log$Employer_Category2))
data_log$Loan_Period[is.na(data_log$Loan_Period)]<-which.max(tabulate(data_log$Loan_Period))
any(is.na(data_log))
any(is.na(Test_Data))
Test_Data$Loan_Period[is.na(Test_Data$Loan_Period)] <- which.max(Test_Data$Loan_Period)
Test_Data$City_Category[is.na(Test_Data$City_Category)] <- which.max(tabulate(Test_Data$City_Category))
Test_Data$Source_Category[is.na(Test_Data$Source_Category)] <- which.max(tabulate(Test_Data$Source_Category))
Test_Data$Employer_Category2[is.na(Test_Data$Employer_Category2)] <- which.max(tabulate(Test_Data$Employer_Category2))
any(is.na(Test_Data))
Test_Data$Interest_Rate[is.na(Test_Data$Interest_Rate)] <- mean(Test_Data$Interest_Rate,na.rm=T)
Test_Data$Existing_EMI[is.na(Test_Data$Existing_EMI)]<-mean(Test_Data$Existing_EMI,na.rm=T)
any(is.na(Test_Data))
M=gbm(data_log$Approved~Gender+City_Category+Employer_Category2+Primary_Bank_Type+Monthly_Income+Source_Category
+Existing_EMI+Loan_Period+Interest_Rate+Var1,distribution='bernoulli',n.trees=3000,data=data_log)
remove(M)
M=gbm(data_log$Approved~Gender+City_Category+Employer_Category2+Primary_Bank_Type+Monthly_Income+Source_Category
+Existing_EMI+Loan_Period+Interest_Rate+Var1,distribution='bernoulli',n.trees=3000,data=data_log)
remove(Pred)
remove(Sample)
Pred=predict.gbm(M,test, n.trees=3000, type='response')
Sample=data.frame(test$ID,Pred)
colnames(Sample)=c("ID","Approved")
write.csv(Sample,"Sample_Solution.csv")
