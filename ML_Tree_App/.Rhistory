p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = TRUE,
gridwidth = 0,
gridcolor = 'white'),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
## Customise the data
data <- data.frame(
Task = c("Boards, KV2, Kalaikunda"  , "High School, KV1, Saltlake, kolkata"  ,"Economics(Honors with Maths & Stats), North Bengal University",
"Marketing and Finance, Globsyn Buisness School","Chegg India Pvt. Ltd(Academics Content Writer)","IBM (IT Operation Associate)",
"Accenture","Data Science(Accenture)","Study in Budhissm","AI"),
Start   = c("2001", "2003", "2006", "2009", "2009-05", "2011","2012","2015","2017","2018"),
duration = c(365,365,365*3,365*3,180,200,365,365*2,365*2,365),
Resource = c("1: School","2: School","3: Grads","4: PG","5:Freelanc","6:1stJob","7:2ndJob","8:Change","9:Break","9Upgrade"))
## Convert the dates into as.Date
data$Start<-as.Date(data$Start, format="%Y")
data$Start<-format(as.Date(data$Start, format = "%Y-%m-%d"), "%Y")
## Establish a session
Sys.setenv("plotly_username"="richie31")
Sys.setenv("plotly_api_key"="up2gX0goI7546ge8IZu1")
## model using plot_ly()
cols <- RColorBrewer::brewer.pal(length(unique(data$Resource)), name = "Set3")
data$color <- factor(data$Resource, labels = cols)
t <- list(
family = "Comic Sans MS",
size = 19,
color = data$color)
## Font for
p <- plot_ly(data, x = ~Start, y=~Resource,type  ='box', color = data$color, text = ~Task)
p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = FALSE,
gridwidth = 0,
gridcolor = 'white',
size = 19),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
## Customise the data
data <- data.frame(
Task = c("Boards, KV2, Kalaikunda"  , "High School, KV1, Saltlake, kolkata"  ,"Economics(Honors with Maths & Stats), North Bengal University",
"Marketing and Finance, Globsyn Buisness School","Chegg India Pvt. Ltd(Academics Content Writer)","IBM (IT Operation Associate)",
"Accenture","Data Science(Accenture)","Study in Budhissm","AI"),
Start   = c("2001", "2003", "2006", "2009", "2009-05", "2011","2012","2015","2017","2018"),
duration = c(365,365,365*3,365*3,180,200,365,365*2,365*2,365),
Resource = c("1: School","2: School","3: Grads","4: PG","5:Freelanc","6:1stJob","7:2ndJob","8:Change","9:Break","9Upgrade"))
## Convert the dates into as.Date
data$Start<-as.Date(data$Start, format="%Y")
data$Start<-format(as.Date(data$Start, format = "%Y-%m-%d"), "%Y")
## Establish a session
Sys.setenv("plotly_username"="richie31")
Sys.setenv("plotly_api_key"="up2gX0goI7546ge8IZu1")
## model using plot_ly()
cols <- RColorBrewer::brewer.pal(length(unique(data$Resource)), name = "Set3")
data$color <- factor(data$Resource, labels = cols)
t <- list(
family = "Comic Sans MS",
size = 19,
color = data$color)
## Font for
p <- plot_ly(data, x = ~Start, y=~Resource,type  ='box', color = data$color, text = ~Task)
p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = FALSE,
gridwidth = 0,
gridcolor = 'white',
fontsize = 19),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
## Customise the data
data <- data.frame(
Task = c("Boards, KV2, Kalaikunda"  , "High School, KV1, Saltlake, kolkata"  ,"Economics(Honors with Maths & Stats), North Bengal University",
"Marketing and Finance, Globsyn Buisness School","Chegg India Pvt. Ltd(Academics Content Writer)","IBM (IT Operation Associate)",
"Accenture","Data Science(Accenture)","Study in Budhissm","AI"),
Start   = c("2001", "2003", "2006", "2009", "2009-05", "2011","2012","2015","2017","2018"),
duration = c(365,365,365*3,365*3,180,200,365,365*2,365*2,365),
Resource = c("1: School","2: School","3: Grads","4: PG","5:Freelanc","6:1stJob","7:2ndJob","8:Change","9:Break","9Upgrade"))
## Convert the dates into as.Date
data$Start<-as.Date(data$Start, format="%Y")
data$Start<-format(as.Date(data$Start, format = "%Y-%m-%d"), "%Y")
## Establish a session
Sys.setenv("plotly_username"="richie31")
Sys.setenv("plotly_api_key"="up2gX0goI7546ge8IZu1")
## model using plot_ly()
cols <- RColorBrewer::brewer.pal(length(unique(data$Resource)), name = "Set3")
data$color <- factor(data$Resource, labels = cols)
t <- list(
family = "Comic Sans MS",
size = 19,
color = data$color)
## Font for
p <- plot_ly(data, x = ~Start, y=~Resource,type  ='box', color = data$color, text = ~Task)
p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = FALSE,
gridwidth = 0,
gridcolor = 'white'),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
## Customise the data
data <- data.frame(
Task = c("Boards, KV2, Kalaikunda"  , "High School, KV1, Saltlake, kolkata"  ,"Economics(Honors with Maths & Stats), North Bengal University",
"Marketing and Finance, Globsyn Buisness School","Chegg India Pvt. Ltd(Academics Content Writer)","IBM (IT Operation Associate)",
"Accenture","Data Science(Accenture)","Study in Budhissm","AI"),
Start   = c("2001", "2003", "2006", "2009", "2009-05", "2011","2012","2015","2017","2018"),
duration = c(365,365,365*3,365*3,180,200,365,365*2,365*2,365),
Resource = c("1: School","2: School","3: Grads","4: PG","5:Freelanc","6:1stJob","7:2ndJob","8:Change","9:Break","9Upgrade"))
## Convert the dates into as.Date
data$Start<-as.Date(data$Start, format="%Y")
data$Start<-format(as.Date(data$Start, format = "%Y-%m-%d"), "%Y")
## Establish a session
Sys.setenv("plotly_username"="richie31")
Sys.setenv("plotly_api_key"="up2gX0goI7546ge8IZu1")
## model using plot_ly()
cols <- RColorBrewer::brewer.pal(length(unique(data$Resource)), name = "Set3")
data$color <- factor(data$Resource, labels = cols)
t <- list(
family = "Comic Sans MS",
size = 19,
color = data$color)
## Font for
p <- plot_ly(data, x = ~Start, y=~Resource,type  ='box', color = data$color, text = ~Task)
p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = FALSE,
gridwidth = 0,
gridcolor = 'white',
titlefont = list(size =19)),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
## Customise the data
data <- data.frame(
Task = c("Boards, KV2, Kalaikunda"  , "High School, KV1, Saltlake, kolkata"  ,"Economics(Honors with Maths & Stats), North Bengal University",
"Marketing and Finance, Globsyn Buisness School","Chegg India Pvt. Ltd(Academics Content Writer)","IBM (IT Operation Associate)",
"Accenture","Data Science(Accenture)","Study in Budhissm","AI"),
Start   = c("2001", "2003", "2006", "2009", "2009-05", "2011","2012","2015","2017","2018"),
duration = c(365,365,365*3,365*3,180,200,365,365*2,365*2,365),
Resource = c("1: School","2: School","3: Grads","4: PG","5:Freelanc","6:1stJob","7:2ndJob","8:Change","9:Break","9Upgrade"))
## Convert the dates into as.Date
data$Start<-as.Date(data$Start, format="%Y")
data$Start<-format(as.Date(data$Start, format = "%Y-%m-%d"), "%Y")
## Establish a session
Sys.setenv("plotly_username"="richie31")
Sys.setenv("plotly_api_key"="up2gX0goI7546ge8IZu1")
## model using plot_ly()
cols <- RColorBrewer::brewer.pal(length(unique(data$Resource)), name = "Set3")
data$color <- factor(data$Resource, labels = cols)
t <- list(
family = "Comic Sans MS",
size = 19,
color = data$color)
## Font for
p <- plot_ly(data, x = ~Start, y=~Resource,type  ='box', color = data$color, text = ~Task)
p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = FALSE,
gridwidth = 0,
gridcolor = 'white',
titlefont = list(size =19,color = "7FC835")),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
## Customise the data
data <- data.frame(
Task = c("Boards, KV2, Kalaikunda"  , "High School, KV1, Saltlake, kolkata"  ,"Economics(Honors with Maths & Stats), North Bengal University",
"Marketing and Finance, Globsyn Buisness School","Chegg India Pvt. Ltd(Academics Content Writer)","IBM (IT Operation Associate)",
"Accenture","Data Science(Accenture)","Study in Budhissm","AI"),
Start   = c("2001", "2003", "2006", "2009", "2009-05", "2011","2012","2015","2017","2018"),
duration = c(365,365,365*3,365*3,180,200,365,365*2,365*2,365),
Resource = c("1: School","2: School","3: Grads","4: PG","5:Freelanc","6:1stJob","7:2ndJob","8:Change","9:Break","9Upgrade"))
## Convert the dates into as.Date
data$Start<-as.Date(data$Start, format="%Y")
data$Start<-format(as.Date(data$Start, format = "%Y-%m-%d"), "%Y")
## Establish a session
Sys.setenv("plotly_username"="richie31")
Sys.setenv("plotly_api_key"="up2gX0goI7546ge8IZu1")
## model using plot_ly()
cols <- RColorBrewer::brewer.pal(length(unique(data$Resource)), name = "Set3")
data$color <- factor(data$Resource, labels = cols)
t <- list(
family = "Comic Sans MS",
size = 19,
color = data$color)
## Font for
p <- plot_ly(data, x = ~Start, y=~Resource,type  ='box', color = data$color, text = ~Task)
p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = FALSE,
gridwidth = 0,
gridcolor = 'white',
titlefont = list(size =19,color = "#BFC835")),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
## Customise the data
data <- data.frame(
Task = c("Boards, KV2, Kalaikunda"  , "High School, KV1, Saltlake, kolkata"  ,"Economics(Honors with Maths & Stats), North Bengal University",
"Marketing and Finance, Globsyn Buisness School","Chegg India Pvt. Ltd(Academics Content Writer)","IBM (IT Operation Associate)",
"Accenture","Data Science(Accenture)","Study in Budhissm","AI"),
Start   = c("2001", "2003", "2006", "2009", "2009-05", "2011","2012","2015","2017","2018"),
duration = c(365,365,365*3,365*3,180,200,365,365*2,365*2,365),
Resource = c("1: School","2: School","3: Grads","4: PG","5:Freelanc","6:1stJob","7:2ndJob","8:Change","9:Break","9Upgrade"))
## Convert the dates into as.Date
data$Start<-as.Date(data$Start, format="%Y")
data$Start<-format(as.Date(data$Start, format = "%Y-%m-%d"), "%Y")
## Establish a session
Sys.setenv("plotly_username"="richie31")
Sys.setenv("plotly_api_key"="up2gX0goI7546ge8IZu1")
## model using plot_ly()
cols <- RColorBrewer::brewer.pal(length(unique(data$Resource)), name = "Set3")
data$color <- factor(data$Resource, labels = cols)
t <- list(
family = "Comic Sans MS",
size = 19,
color = data$color)
## Font for
p <- plot_ly(data, x = ~Start, y=~Resource,type  ='box', color = data$color, text = ~Task)
p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = FALSE,
gridwidth = 0,
gridcolor = 'white',
titlefont = list(size =19,color = "#C8AD35")),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = FALSE,
gridwidth = 0,
gridcolor = 'white',
titlefont = list(size =19,color = "#C88735")),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
## Customise the data
data <- data.frame(
Task = c("Boards, KV2, Kalaikunda"  , "High School, KV1, Saltlake, kolkata"  ,"Economics(Honors with Maths & Stats), North Bengal University",
"Marketing and Finance, Globsyn Buisness School","Chegg India Pvt. Ltd(Academics Content Writer)","IBM (IT Operation Associate)",
"Accenture","Data Science(Accenture)","Study in Budhissm","AI"),
Start   = c("2001", "2003", "2006", "2009", "2009-05", "2011","2012","2015","2017","2018"),
duration = c(365,365,365*3,365*3,180,200,365,365*2,365*2,365),
Resource = c("1: School","2: School","3: Grads","4: PG","5:Freelanc","6:1stJob","7:2ndJob","8:Change","9:Break","9Upgrade"))
## Convert the dates into as.Date
data$Start<-as.Date(data$Start, format="%Y")
data$Start<-format(as.Date(data$Start, format = "%Y-%m-%d"), "%Y")
## Establish a session
Sys.setenv("plotly_username"="richie31")
Sys.setenv("plotly_api_key"="up2gX0goI7546ge8IZu1")
## model using plot_ly()
cols <- RColorBrewer::brewer.pal(length(unique(data$Resource)), name = "Set3")
data$color <- factor(data$Resource, labels = cols)
t <- list(
family = "Comic Sans MS",
size = 19,
color = data$color)
## Font for
p <- plot_ly(data, x = ~Start, y=~Resource,type  ='box', color = data$color, text = ~Task)
p %>% add_markers() %>%
add_text(textfont = t, textposition = "top right")%>%
layout(xaxis = list(title = "Year",
showline = TRUE,
linewidth = 6,
linecolor = '#C89935',
showgrid = FALSE,
gridwidth = 0,
gridcolor = 'white',
titlefont = list(size =19,color = "#C88735")),
yaxis = list(title = "",
zeroline = FALSE,
showline = FALSE,
showgrid = FALSE),
showlegend = FALSE)
## Set the working directory
setwd("D:/Documents/R_Projects/Data_Camp_Tutorials/ML_Tree_App")
## load the dataset
data_x = read.csv("credit.csv")
## Preprocessing the dataset
data_x$default <- ifelse(data_x$default == "yes", 1, 0)
## split the dataset
get_dataset<- function(x, split_ratio = 0.8, set = 'train'){
if (set == 'train'){
n <- nrow(data_x)
shuffled <- data_x[sample(n),]
# Split the data in train and test
train <- shuffled[1:round(split_ratio * n),]
test <- shuffled[(round(split_ratio * n) + 1):n,]
return(train)
}
if(set == 'test'){
n <- nrow(data_x)
shuffled <- data_x[sample(n),]
# Split the data in train and test
train <- shuffled[1:round(split_ratio * n),]
test <- shuffled[(round(split_ratio * n) + 1):n,]
return(test)
}
else
return (NULL)
}
train = get_dataset(data_x, set = 'train')
nrow(train)
test= get_dataset(data_x, set = 'test')
nrow(test)
## load the necessary packages
pacman::p_load(shiny,shinydashboard,gbm, randomForest,ggplot2,ipred,caret,ROCR,dplyr,ModelMetrics)
## User Defined Function for loading data, splitting and fitting the model
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set='AUC',n.trees=10000){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
## get the AUC for different algo
get_auc= function(algo, type,n.trees){
z = model(algo = algo,type = type, set ='AUC')
}
GBM_auc = get_auc(gbm)
GBM_auc = get_auc(algo = gbm, type='reponse')
RF_auc = get_auc(randomForest, type ='response')
RF_auc
BAG_auc
BAG_auc = get_auc(bagging, type ='class')
BAG_auc
GBM_auc = get_auc(algo = gbm, type='response')
GBM_auc
get_pred<- function(algo, type, n.trees =10000){
z= model(algo = algo, type= type, set = 'predictions')
}
BAG_preds<- get_pred(algo = bagging, type= 'class')
RF_pred<- get_pred(algo = randomForest, type ='response')
GBM_pred<- get_pred(algo = gbm, type = 'response')
pred_list<-list(BAG_preds,RF_pred, GBM_pred)
get_model<- function(algo,type = 'response', ntrees = 10000){
z= model(algo = algo, type= type, set = 'model')
}
Bag_model<- get_model(algo = bagging, type='prob')
RF_model<- get_model(algo = randomForest)
GBM_model<- get_model(algo = gbm)
m<-length(pred_list)
actual_list<-rep(list(test$default),m)
pred <- prediction(pred_list, actual_list)
roc <- performance(pred, "tpr", "fpr")
plot(roc, col = as.list(1:m), main = "Test Set ROC Curves")
legend(x = "bottomright",
legend = c("Bagged Trees", "Random Forest", "GBM"),
fill = 1:m)
get_ROC = function(pred_list, actual = test$default, legend){
pred<-prediction(pred_list, actual)
roc<-performance(pred,"tpr","fpr")
plot(roc, main = "Test Set ROC Curves")
legend(x = "bottomright",
legend = legend)
}
get_ROC(pred_list = GBM_pred,legend = "Random Forest")
ntree_gbm_cv <- gbm.perf(object = GBM_model,
method = "cv")
GBM_A<-get_auc(algo = gbm,type='response',n.trees = ntree_gbm_cv)
GBM_A
train_rf<- train
test_rf<-test
train_rf$default<-as.factor(train_rf$default)
mtry <- seq(1, ncol(train) * 0.8, 2)
nodesize <- seq(3, 8, 2)
sampsize <- nrow(train) * c(0.7, 0.8)
# Create a data frame containing all combinations
hyper_grid <- expand.grid(mtry = mtry, nodesize = nodesize, sampsize = sampsize)
# Create an empty vector to store OOB error values
oob_err <- c()
# Write a loop over the rows of hyper_grid to train the grid of models
for (i in 1:nrow(hyper_grid)) {
# Train a Random Forest model
model <- randomForest(as.factor(train_rf$default) ~ .,
data = train_rf,
distribution ='bernoulli',
mtry = hyper_grid$mtry[i],
nodesize = hyper_grid$nodesize[i],
sampsize = hyper_grid$sampsize[i],
ntrees = 10000)
# Store OOB error for the model
oob_err[i] <- model$err.rate[nrow(model$err.rate), "OOB"]
}
opt_i <- which.min(oob_err)
optimal_grid_options<-print(hyper_grid[opt_i,])
opt_i
model$err.rate
plot(model$err.rate)
optimal_grid_options<-print(hyper_grid[opt_i,])
optimal_grid_options[1]
optimal_grid_options[[1]]
model_rf<-randomForest(train_rf$default ~ .,
data = train_rf,
distribution ='bernoulli',
mtry = optimal_grid_options[[1]],
nodesize = hyper_grid$nodesize[[2]],
sampsize = hyper_grid$sampsize[[3]],
ntrees = 10000)
predict_opt<-predict(object = model,
newdata = test_rf,
n.trees = 10000,
type = 'response')
predict_opt
RF_pred
predict_opt<-predict(object = model,
newdata = test_rf,
n.trees = 10000,
type = 'prob')
predict_opt
predict_opt[,2]
model_rf_AUC<-auc(actual = test$default, predicted = predict_opt[,2])
model_rf_AUC
RF_auc
model_rf_AUC<-auc(actual = test$default, predicted = predict_opt[,1])
model_rf_AUC
model_rf_AUC<-auc(actual = test$default, predicted = predict_opt[,2])
model_rf_AUC
z<-randomForest(as.factor(train$default)~.,
data = train)
predict_z<-predict(object = model,
newdata = test,
type='prob')
predict_z
predict_z_auc<-auc(actual = test$default, predicted = predict_opt[,2])
predict_z_auc
model_rf_AUC
predict_opt<-predict(object = model,
newdata = test_rf,
n.trees = 10000,
type = 'response')
model_rf_AUC<-auc(actual = test$default, predicted = predict_opt[,2])
model_rf_AUC<-auc(actual = test$default, predicted = predict_opt)
model_rf_AUC
