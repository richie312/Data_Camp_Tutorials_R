if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
get_auc= function(algo, type,n.trees){
z = model(algo = algo,type = type, set ='AUC')
}
GBM_auc = get_auc(gbm, type = 'response')
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees =1000)
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees =200)
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees =100)
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees =50)
GBM_auc
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =500){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
get_pred<- function(algo, type, n.trees =50){
z= model(algo = algo, type= type, set = 'predictions')
}
BAG_preds<- get_pred(algo = bagging, type= 'class')
RF_pred<- get_pred(algo = randomForest, type ='response')
GBM_pred<- get_pred(algo = gbm, type = 'response')
ntree_OOB_BAG <- gbm.perf(object = GBM_model,
method = "OOB",
oobag.curve = TRUE)
ntree_OOB_BAG <- gbm.perf(object = GBM_model,
method = "OOB",
oobag.curve = TRUE)
ntree_OOB_BAG
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =500){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
GBM_auc = get_auc(gbm, type = 'response', n.trees =50)
GBM_auc
ntree_OOB_BAG <- gbm.perf(object = GBM_model,
method = "cv",
oobag.curve = TRUE)
ntree_OOB_BAG <- gbm.perf(object = GBM_model,
method = "cv")
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =500){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
Bag_model<- get_model(algo = bagging, type='prob')
RF_model<- get_model(algo = randomForest)
GBM_model<- get_model(algo = gbm)
ntree_OOB_BAG <- gbm.perf(object = GBM_model,
method = "cv")
ntree_OOB_BAG
GBM_auc = get_auc(gbm, type = 'response', n.trees =50)
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees =500)
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees =500)
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees =1000)
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees =1200)
GBM_auc
ntree_OOB_BAG <- gbm.perf(object = GBM_model,
method = "cv")
ntree_OOB_BAG
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =500){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
BAG_preds<- get_pred(algo = bagging, type= 'class')
RF_pred<- get_pred(algo = randomForest, type ='response')
GBM_pred<- get_pred(algo = gbm, type = 'response')
ntree_OOB_BAG <- gbm.perf(object = GBM_model,
method = "cv")
ntree_OOB_BAG
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =2500){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
GBM_pred<- get_pred(algo = gbm, type = 'response')
ntree_OOB_BAG <- gbm.perf(object = GBM_model,
method = "cv")
ntree_OOB_BAG
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =2500){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
GBM_auc = get_auc(gbm, type = 'response')
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees  =500)
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees  =2500)
GBM_auc
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =10000){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
GBM_auc = get_auc(gbm, type = 'response')
GBM_auc
ntree_OOB_BAG <- gbm.perf(object = GBM_model,
method = "cv")
ntree_OOB_BAG
ntree_gbm_cv <- gbm.perf(object = GBM_model,
method = "cv")
GBM_model<- get_model(algo = gbm)
ntree_gbm_cv <- gbm.perf(object = GBM_model,
method = "cv")
ntree_gbm_cv
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =2500){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
GBM_model<- get_model(algo = gbm)
ntree_gbm_cv <- gbm.perf(object = GBM_model,
method = "cv")
ntree_gbm_cv
get_model(algo=gbm,type='response',ntrees = ntree_gbm_cv)
get_model<- function(algo,type = 'response', ntrees = 2500){
z= model(algo = algo, type= type, set = 'model')
}
GBM_model=get_model(algo=gbm,type='response',ntrees = ntree_gbm_cv)
GBM_model
GBM_auc = get_auc(gbm, type = 'response', ntrees = 9400)
GBM_auc = get_auc(gbm, type = 'response', n.trees = 9400)
GBM_auc
GBM_auc = get_auc(gbm, type = 'response', n.trees = 10000)
GBM_auc
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =10000){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
get_auc= function(algo, type,n.trees){
z = model(algo = algo,type = type, set ='AUC')
}
get_pred<- function(algo, type, n.trees =10000){
z= model(algo = algo, type= type, set = 'predictions')
}
get_model<- function(algo,type = 'response', ntrees = 10000){
z= model(algo = algo, type= type, set = 'model')
}
ntree_gbm_cv <- gbm.perf(object = GBM_model,
method = "cv")
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =10000){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
GBM_model<- get_model(algo = gbm)
ntree_gbm_cv <- gbm.perf(object = GBM_model,
method = "cv")
ntree_gbm_cv
get_auc(algo = gbm,n.trees = ntree_gbm_cv)
get_auc(algo = gbm,type='resposne',n.trees = ntree_gbm_cv)
get_auc(algo = gbm,type='response',n.trees = ntree_gbm_cv)
z<-get_auc(algo = gbm,type='response',n.trees = ntree_gbm_cv)
z
z<-get_auc(algo = gbm,type='response',n.trees = 10000)
z
GBM_auc = get_auc(gbm, type = 'response')
RF_auc = get_auc(randomForest, type ='response')
BAG_auc = get_auc(bagging, type ='class')
GBM_auc
RF_auc
BAG_auc
BAG_preds<- get_pred(algo = bagging, type= 'class')
RF_pred<- get_pred(algo = randomForest, type ='response')
GBM_pred<- get_pred(algo = gbm, type = 'response')
model = function(algo =gbm ,distribution = 'bernoulli',
type = 'response', set ='AUC',n.trees =10000){
## Fit the model
model<- algo(formula = default ~ .,
distribution = distribution,
data = train,
n.trees = n.trees,
cv.fold= 3)
## Generate the prediction on the test set
pred<- predict(object = model,
newdata = test,
n.trees = n.trees,
type = type)
## Generate the test set AUCs using the pred
library(ModelMetrics)
AUC<- auc(actual = test$default, predicted = pred)
if (set == 'AUC'){
return(AUC)
}
if (set == 'predictions'){
return(pred)
}
if (set == 'model'){
return(model)
}
else
return(NULL)
}
pred_list<-list(BAG_preds,RF_pred, GBM_pred)
Bag_model<- get_model(algo = bagging, type='prob')
RF_model<- get_model(algo = randomForest)
GBM_model<- get_model(algo = gbm)
m<-length(pred_list)
actual_list<-rep(list(test$default),m)
pred <- prediction(pred_list, actual_list)
roc <- performance(pred, "tpr", "fpr")
plot(roc, col = as.list(1:m), main = "Test Set ROC Curves")
legend(x = "bottomright",
legend = c("Bagged Trees", "Random Forest", "GBM"),
fill = 1:m)
?tuneRF
randomForest.perf(object=RF_model, method ='cv')
RF_model$oob.times
RF_model$err.rate
?randomForest
RF_model_oob<-randomForest(default~.,data= train, mtry =2,nodesize=3, sampsize=600)
RF_model_oob$mtry
RF_model$mtry
RF_model$inbag
RF_model$forest
set.seed(123)
rm(RF_model_oob)
mtry <- seq(1, ncol(train) * 0.8, 2)
nodesize <- seq(3, 8, 2)
sampsize <- nrow(train) * c(0.7, 0.8)
hyper_grid <- expand.grid(mtry = mtry, nodesize = nodesize, sampsize = sampsize)
oob_err <- c()
mtry
nodesize
sampsize
hyper_grid <- expand.grid(mtry = mtry, nodesize = nodesize, sampsize = sampsize)
hyper_grid
id of models
for (i in 1:nrow(hyper_grid)) {
# Train a Random Forest model
model <- randomForest(default ~ .,
data = train,
distribution ='bernoulli',
mtry = hyper_grid$mtry[i],
nodesize = hyper_grid$nodesize[i],
sampsize = hyper_grid$sampsize[i],
ntrees = 10000)
# Store OOB error for the model
oob_err[i] <- model$err.rate[nrow(model$err.rate), "OOB"]
}
oob_err
opt_i <- which.min(oob_err)
opt_i
optimal_grid_options<-print(hyper_grid[opt_i,])
RF_model_oob<-randomForest(default~.,data= train, mtry =2,nodesize=3, sampsize=600, n.trees=500)
RF_model_oob$predicted
RF_model_oob$mse
RF_model_oob<-randomForest(default~.,data= train, mtry =2,nodesize=3, sampsize=600, n.trees=500)
summary(RF_model_oob)
print(RF_model)
z<-randomForest(train$default~.)
z<-randomForest(train$default~., data=data)
ncol(train)
names(train)
z<-randomForest(default~., data=data)
remove.packages("randomForest")
install.pacakges(randomForest())
randomForest()
install.pacakges(randomForest())
install.pacakges(randomForest)
remove.packages("randomForest")
randomForest::randomForest(default~.,data=train)
remove.packages(randomForest)
remove.packages('randomForest')
