---
title: "When and How you should write a function"
output: html_notebook
---

# When and How to Write a Function

## Rescale

```{r, eval =FALSE}

# Define example vector x

x=(1:10)

# Rewrite this snippet to refer to x
(df$a - min(df$a, na.rm = TRUE)) /
  (max(df$a, na.rm = TRUE) - min(df$a, na.rm = TRUE))
  
  (x-min(x,na.rm=TRUE))/(max(x,na.rm=TRUE)-min(x,na.rm=TRUE))




```

##Replace it with Range Function

```{r, eval=FALSE}

# Define example vector x
x <- 1:10

# Define rng

rng = range(x, na.rm = TRUE)

# Rewrite this snippet to refer to the elements of rng
(x - min(x, na.rm = TRUE)) /
  (max(x, na.rm = TRUE) - min(x, na.rm = TRUE))
  
  ## Rewrite
  
  (x-min(x,na.rm=TRUE))/rng

```


## Finally turn it into a function!

```{r,eval=FALSE}

# Define example vector x
x <- 1:10 

# Use the function template to create the rescale01 function
my_fun <- function(arg1, arg2) {
  # body
  
}

# Test your function, call rescale01 using the vector x as the argument

rescale01<-function(x){
  
  rng <- range(x, na.rm = TRUE)
  (x - rng[1]) / (rng[2] - rng[1])
}


```

## When and How to write a function
### Start with a simple problem

```{r, eval=FALSE}

# Define example vectors x and y
x <- c( 1, 2, NA, 3, NA)
y <- c(NA, 3, NA, 3,  4)

# Count how many elements are missing in both x and y

sum(is.na(x) & is.na(y))
```

## Turn the above snippet into function

```{r, eval = FALSE}

# Define example vectors x and y
x <- c( 1, 2, NA, 3, NA)
y <- c(NA, 3, NA, 3,  4)

# Turn this snippet into a function: both_na()
both_na=function(x,y){
  sum(is.na(x) & is.na(y))
}
both_na(x,y)

```


## Put our function to use

```{r, eval = FALSE}

# Define x, y1 and y2
x <-  c(NA, NA, NA)
y1 <- c( 1, NA, NA)
y2 <- c( 1, NA, NA, NA)

# Call both_na on x, y1

both_na(x,y1)
# Call both_na on x, y2
both_na(x,y2)

```


## How can you write a good function

### Good Function names

```{r, eval =FALSE}

mean_ci<-function(level,x){
  se<-sd(x)/sqrt(length(x))
  alpha<- 1 - level
  mean(x) + se*qnorm(c(alpha/2,1-alpha/2))
  
```

## Argument Order

#### Put default value to the arguement

```{r, eval =FALSE}

mean_ci <- function(x, level = 0.95) {
  se <- sd(x) / sqrt(length(x))
  alpha <- 1 - level
  mean(x) + se * qnorm(c(alpha / 2, 1 - alpha / 2))
}
```


## Return Statements

```{r, eval = FALSE}

mean_ci <- function(x, level = 0.95) {
  if (length(x) == 0){
    warning("x was empty", call. = FALSE)
    return(c(-Inf,Inf))} else {
  se <- sd(x) / sqrt(length(x))
  alpha <- 1 - level
  mean(x) + se * qnorm(c(alpha / 2, 1 - alpha / 2))}
}

```

## Replacement Funciton for missing values in a dataframe column

```{r, eval = FALSE}

# Rewrite the call on df$z to match our new names
replace_missings <- function(x, replacement) {
  # Change the name of the y argument to replacement
  x[is.na(x)] <- replacement
  cat(sum(is.na(x)), replacement, "\n")
  x
}

df$z <- replace_missings(df$z, replacement = 0)

```


































































































